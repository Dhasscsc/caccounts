<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>родро╛ро╕рпН рокрпКродрпБ роЪрпЗро╡рпИ роорпИропроорпН - ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН роорпЗро▓ро╛рогрпНроорпИ</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Nirmala UI', 'Latha', sans-serif;
        }
        body {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            margin: 0;
            padding: 20px;
            color: #2c3e50;
            min-height: 100vh;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.15);
            overflow: hidden;
            border: 3px solid #2c3e50;
        }
        .header-top {
            background: linear-gradient(135deg, #1a237e, #283593);
            color: white;
            padding: 25px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        .company-info {
            flex: 1;
            min-width: 300px;
        }
        .company-name {
            font-size: 32px;
            font-weight: 800;
            margin: 0 0 10px 0;
            color: #fff;
            letter-spacing: 1px;
        }
        .company-tagline {
            font-size: 16px;
            opacity: 0.9;
            margin: 0 0 15px 0;
        }
        .company-details {
            font-size: 14px;
            line-height: 1.6;
            opacity: 0.8;
        }
        .contact-info {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            margin-left: 30px;
            min-width: 300px;
        }
        .contact-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            font-size: 14px;
        }
        .contact-item:last-child {
            margin-bottom: 0;
        }
        .contact-icon {
            margin-right: 10px;
            font-size: 18px;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            padding: 25px 40px;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }
        @media (max-width: 1200px) {
            .dashboard {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        @media (max-width: 600px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            text-align: center;
            border-top: 6px solid;
            transition: transform 0.3s;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        .stat-card h3 {
            margin-top: 0;
            color: #495057;
            font-size: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .stat-card .amount {
            font-size: 34px;
            font-weight: 800;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
        }
        .customers { border-color: #3498db; }
        .active { border-color: #2ecc71; }
        .debt { border-color: #e74c3c; }
        .revenue { border-color: #f39c12; }
        .positive { color: #27ae60; }
        .negative { color: #e74c3c; }
        
        .tabs {
            display: flex;
            background: #2c3e50;
            border-bottom: 2px solid #1a252f;
        }
        .tab-btn {
            padding: 20px 35px;
            background: none;
            border: none;
            font-size: 18px;
            font-weight: 600;
            color: #bdc3c7;
            cursor: pointer;
            position: relative;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .tab-btn:hover {
            color: white;
            background: rgba(255,255,255,0.1);
        }
        .tab-btn.active {
            color: white;
            background: #3498db;
        }
        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 3px;
            background: white;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 400px 1fr;
            min-height: 800px;
        }
        @media (max-width: 1100px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .sidebar {
            background: #f8f9fa;
            padding: 35px;
            border-right: 2px solid #dee2e6;
        }
        .content-area {
            padding: 35px;
            background: white;
            overflow-x: auto;
        }
        
        .form-container, .services-container, .reports-container {
            display: none;
            animation: fadeIn 0.5s;
        }
        .form-container.active, .services-container.active, .reports-container.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .form-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 15px;
        }
        label.required::after {
            content: ' *';
            color: #e74c3c;
        }
        input, select, textarea {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #ced4da;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            background: white;
        }
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .service-checkboxes {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 10px;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        button {
            padding: 16px 32px;
            border: none;
            border-radius: 10px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        .primary-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            flex: 1;
        }
        .primary-btn:hover {
            background: linear-gradient(135deg, #2980b9, #3498db);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.3);
        }
        .secondary-btn {
            background: #2ecc71;
            color: white;
        }
        .secondary-btn:hover {
            background: #27ae60;
            transform: translateY(-3px);
        }
        .danger-btn {
            background: #e74c3c;
            color: white;
        }
        .danger-btn:hover {
            background: #c0392b;
        }
        .warning-btn {
            background: #f39c12;
            color: white;
        }
        .warning-btn:hover {
            background: #e67e22;
        }
        .outline-btn {
            background: white;
            color: #2c3e50;
            border: 2px solid #ced4da;
        }
        .outline-btn:hover {
            background: #f8f9fa;
            border-color: #3498db;
        }
        .print-btn {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
        }
        .print-btn:hover {
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
        }
        
        .search-filter {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
        }
        .search-filter input, .search-filter select {
            flex: 1;
            min-width: 250px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border-radius: 15px;
            overflow: hidden;
            border: 2px solid #dee2e6;
        }
        thead {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
        }
        th, td {
            padding: 18px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
            white-space: nowrap;
        }
        th {
            font-weight: 700;
            font-size: 15px;
            letter-spacing: 0.5px;
            position: sticky;
            top: 0;
        }
        tr:hover {
            background-color: #f8f9fa;
        }
        tr.debt-high {
            background-color: #ffeaea;
            border-left: 4px solid #e74c3c;
        }
        tr.debt-medium {
            background-color: #fff4e6;
            border-left: 4px solid #f39c12;
        }
        
        .customer-id {
            font-weight: 700;
            color: #2c3e50;
            font-family: 'Courier New', monospace;
        }
        .customer-name {
            font-weight: 700;
            color: #2c3e50;
            font-size: 17px;
        }
        .customer-phone {
            color: #3498db;
            font-weight: 600;
            font-family: 'Courier New', monospace;
        }
        
        .debt-amount {
            color: #e74c3c;
            font-weight: 700;
            font-size: 18px;
        }
        .paid-amount {
            color: #27ae60;
            font-weight: 700;
        }
        .balance-amount {
            color: #f39c12;
            font-weight: 700;
        }
        
        .status-badge {
            display: inline-block;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }
        .status-active {
            background: #d4edda;
            color: #155724;
        }
        .status-inactive {
            background: #f8d7da;
            color: #721c24;
        }
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .service-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        .service-tag {
            background: #e3f2fd;
            color: #1565c0;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        .small-btn {
            padding: 8px 15px;
            font-size: 14px;
            border-radius: 8px;
        }
        
        .no-data {
            text-align: center;
            padding: 60px;
            color: #6c757d;
        }
        .no-data-icon {
            font-size: 80px;
            margin-bottom: 20px;
            opacity: 0.3;
        }
        
        .payment-history {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }
        .payment-item {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            border-bottom: 1px solid #dee2e6;
            background: white;
            margin-bottom: 10px;
            border-radius: 8px;
        }
        
        .report-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            margin-bottom: 25px;
            border: 2px solid #dee2e6;
        }
        
        footer {
            text-align: center;
            padding: 25px;
            color: #2c3e50;
            font-size: 15px;
            border-top: 2px solid #dee2e6;
            background: #f8f9fa;
        }
        
        @media print {
            .no-print {
                display: none !important;
            }
            body {
                background: white;
                padding: 0;
                font-size: 12px;
            }
            .container {
                box-shadow: none;
                border-radius: 0;
                border: none;
            }
            .main-content {
                display: block;
            }
            .sidebar {
                display: none;
            }
            table {
                font-size: 11px;
                box-shadow: none;
            }
            th, td {
                padding: 10px 12px;
            }
            .print-header {
                text-align: center;
                margin-bottom: 40px;
                padding-bottom: 20px;
                border-bottom: 3px solid #2c3e50;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-top">
            <div class="company-info">
                <h1 class="company-name">родро╛ро╕рпН рокрпКродрпБ роЪрпЗро╡рпИ роорпИропроорпН</h1>
                <p class="company-tagline">(роородрпНродро┐роп рооро╛роиро┐ро▓ роЕро░роЪрпБ роЕроЩрпНроХрпАроХро╛ро░роорпН рокрпЖро▒рпНро▒родрпБ)</p>
                <div class="company-details">
                    147роО, роХро┐ро░рпЗроЯрпН роХро╛роЯрпНроЯройрпН ро░рпЛроЯрпБ, роородрпНродро┐роп рокро╛роХроорпН роХро╛ро╡ро▓рпН роиро┐ро▓рпИропроорпН роОродро┐ро░ро┐ро▓рпН,<br>
                    родрпВродрпНродрпБроХрпНроХрпБроЯро┐-628001
                </div>
            </div>
            <div class="contact-info">
                <div class="contact-item">
                    <span class="contact-icon">ЁЯУ▒</span>
                    <span>98 43 23 23 24 / 88 70 23 23 32 / 95 85 33 43 65</span>
                </div>
                <div class="contact-item">
                    <span class="contact-icon">тЬЙя╕П</span>
                    <span>dhasscsc@gmail.com</span>
                </div>
                <div class="contact-item">
                    <span class="contact-icon">ЁЯПв</span>
                    <span>родрпВродрпНродрпБроХрпНроХрпБроЯро┐ рокрпКродрпБ роЪрпЗро╡рпИ роорпИропроорпН</span>
                </div>
                <div class="contact-item">
                    <span class="contact-icon">тП░</span>
                    <span>родро┐роЩрпНроХро│рпН - роЪройро┐: 9:00 AM - 8:00 PM</span>
                </div>
            </div>
        </div>
        
        <div class="dashboard no-print">
            <div class="stat-card customers">
                <h3>роорпКродрпНрод ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН</h3>
                <div class="amount" id="total-customers">0</div>
                <p>рокродро┐ро╡рпБроЪрпЖропрпНрод ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН</p>
            </div>
            <div class="stat-card active">
                <h3>роЪрпЖропро▓ро┐ро▓рпН роЙро│рпНро│ро╡ро░рпНроХро│рпН</h3>
                <div class="amount" id="active-customers">0</div>
                <p>родро▒рпНрокрпЛродрпБ роЪрпЗро╡рпИ рокрпЖро▒рпБрокро╡ро░рпНроХро│рпН</p>
            </div>
            <div class="stat-card debt">
                <h3>роорпКродрпНрод роХроЯройрпН родрпКроХрпИ</h3>
                <div class="amount negative" id="total-debt">тВ╣0</div>
                <p>роЪрпЖро▓рпБродрпНродрокрпНрокроЯ ро╡рпЗрогрпНроЯро┐ропродрпБ</p>
            </div>
            <div class="stat-card revenue">
                <h3>роорпКродрпНрод ро╡ро░рпБро╡ро╛ропрпН</h3>
                <div class="amount positive" id="total-revenue">тВ╣0</div>
                <p>роЪрпЖро▓рпБродрпНродрокрпНрокроЯрпНроЯ родрпКроХрпИ</p>
            </div>
        </div>
        
        <div class="tabs no-print">
            <button class="tab-btn active" onclick="switchTab('customer')">
                ЁЯСд рокрпБродро┐роп ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН
            </button>
            <button class="tab-btn" onclick="switchTab('customers')">
                ЁЯУЛ ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН
            </button>
            <button class="tab-btn" onclick="switchTab('payment')">
                ЁЯТ░ роХроЯрпНроЯрогроорпН роЪрпЗро░рпНроХрпНроХ
            </button>
            <button class="tab-btn" onclick="switchTab('reports')">
                ЁЯУК роЕро▒ро┐роХрпНроХрпИроХро│рпН
            </button>
            <button class="tab-btn" onclick="switchTab('services')">
                ЁЯФз роЪрпЗро╡рпИроХро│рпН
            </button>
        </div>
        
        <div class="main-content">
            <div class="sidebar no-print">
                <div class="form-container active" id="customer-tab">
                    <h2 style="color: #2c3e50; margin-top: 0;">рокрпБродро┐роп ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН рокродро┐ро╡рпБ</h2>
                    
                    <div class="form-section">
                        <form id="customer-form">
                            <div class="form-group">
                                <label for="customer-name" class="required">ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН рокрпЖропро░рпН</label>
                                <input type="text" id="customer-name" placeholder="роорпБро┤рпБрокрпН рокрпЖропро░рпН" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="customer-phone" class="required">роЪрпЖро▓рпН роироорпНрокро░рпН</label>
                                <input type="tel" id="customer-phone" placeholder="98 43 23 23 24" pattern="[0-9]{10}" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="customer-phone2">рооро╛ро▒рпНро▒рпБ роЪрпЖро▓рпН роироорпНрокро░рпН</label>
                                <input type="tel" id="customer-phone2" placeholder="рооро╛ро▒рпНро▒рпБ родрпКроЯро░рпНрокрпБ роОрогрпН">
                            </div>
                            
                            <div class="form-group">
                                <label for="customer-address" class="required">роорпБроХро╡ро░ро┐</label>
                                <textarea id="customer-address" rows="3" placeholder="роорпБро┤рпБ роорпБроХро╡ро░ро┐" required></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="customer-aadhar">роЖродро╛ро░рпН роОрогрпН</label>
                                <input type="text" id="customer-aadhar" placeholder="12 роЗро▓роХрпНроХ роЖродро╛ро░рпН роОрогрпН">
                            </div>
                            
                            <div class="form-group">
                                <label>рокрпЖро▒рпНро▒ роЪрпЗро╡рпИроХро│рпН</label>
                                <div class="service-checkboxes" id="services-list">
                                    <!-- роЪрпЗро╡рпИроХро│рпН роЗроЩрпНроХрпЗ роЬро╛ро╡ро╛ро╕рпНроХро┐ро░ро┐рокрпНроЯрпН роорпВро▓роорпН роЪрпЗро░рпНроХрпНроХрокрпНрокроЯрпБроорпН -->
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="total-amount">роорпКродрпНрод родрпКроХрпИ (тВ╣)</label>
                                <input type="number" id="total-amount" placeholder="0" min="0" step="100">
                            </div>
                            
                            <div class="form-group">
                                <label for="paid-amount">роЪрпЖро▓рпБродрпНродро┐роп родрпКроХрпИ (тВ╣)</label>
                                <input type="number" id="paid-amount" placeholder="0" min="0" step="100">
                            </div>
                            
                            <div class="form-group">
                                <label for="customer-notes">роХрпБро▒ро┐рокрпНрокрпБроХро│рпН</label>
                                <textarea id="customer-notes" rows="2" placeholder="роХрпВроЯрпБродро▓рпН ро╡ро┐ро╡ро░роЩрпНроХро│рпН"></textarea>
                            </div>
                            
                            <input type="hidden" id="customer-id">
                            
                            <div class="btn-group">
                                <button type="submit" class="primary-btn" id="submit-btn">
                                    ЁЯТ╛ ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпИ роЪрпЗро░рпНроХрпНроХ
                                </button>
                                <button type="button" class="secondary-btn" id="update-btn" style="display:none;">
                                    тЬПя╕П рокрпБродрпБрокрпНрокро┐роХрпНроХ
                                </button>
                                <button type="button" class="outline-btn" id="cancel-btn" style="display:none;">
                                    тЭМ ро░родрпНродрпБ роЪрпЖропрпНроХ
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <div class="form-container" id="payment-tab">
                    <h2 style="color: #2c3e50; margin-top: 0;">роХроЯрпНроЯрогроорпН рокродро┐ро╡рпБ роЪрпЖропрпНроХ</h2>
                    
                    <div class="form-section">
                        <form id="payment-form">
                            <div class="form-group">
                                <label for="payment-customer" class="required">ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН</label>
                                <select id="payment-customer" required>
                                    <option value="">ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-date" class="required">роХроЯрпНроЯрог родрпЗродро┐</label>
                                <input type="date" id="payment-date" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-amount" class="required">роХроЯрпНроЯрог родрпКроХрпИ (тВ╣)</label>
                                <input type="number" id="payment-amount" placeholder="0" min="0" step="100" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-mode">роХроЯрпНроЯрог роорпБро▒рпИ</label>
                                <select id="payment-mode">
                                    <option value="cash">рокрогроорпН</option>
                                    <option value="online">роЖройрпНро▓рпИройрпН</option>
                                    <option value="cheque">роЪрпЖроХрпН</option>
                                    <option value="upi">UPI</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-reference">ро░роЪрпАродрпБ роОрогрпН / роХрпБро▒ро┐рокрпНрокрпБ</label>
                                <input type="text" id="payment-reference" placeholder="ро░роЪрпАродрпБ роОрогрпН роЕро▓рпНро▓родрпБ роХрпБро▒ро┐рокрпНрокрпБ">
                            </div>
                            
                            <div class="form-group">
                                <label for="payment-notes">роХрпБро▒ро┐рокрпНрокрпБроХро│рпН</label>
                                <textarea id="payment-notes" rows="2" placeholder="роХрпВроЯрпБродро▓рпН ро╡ро┐ро╡ро░роЩрпНроХро│рпН"></textarea>
                            </div>
                            
                            <div class="btn-group">
                                <button type="submit" class="primary-btn">
                                    ЁЯТ░ роХроЯрпНроЯрогроорпН рокродро┐ро╡рпБ роЪрпЖропрпНроХ
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <div id="customer-balance-info" style="display: none;">
                        <!-- ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН рокрпЗро▓ройрпНро╕рпН родроХро╡ро▓рпН роЗроЩрпНроХрпЗ роХро╛роЯрпНроЯрокрпНрокроЯрпБроорпН -->
                    </div>
                </div>
                
                <div class="services-container" id="services-tab">
                    <h2 style="color: #2c3e50; margin-top: 0;">роЪрпЗро╡рпИ роорпЗро▓ро╛рогрпНроорпИ</h2>
                    
                    <div class="form-section">
                        <h3>рокрпБродро┐роп роЪрпЗро╡рпИ роЪрпЗро░рпНроХрпНроХ</h3>
                        <form id="service-form">
                            <div class="form-group">
                                <label for="service-name" class="required">роЪрпЗро╡рпИ рокрпЖропро░рпН</label>
                                <input type="text" id="service-name" placeholder="роО.роХро╛: роЖродро╛ро░рпН роХро╛ро░рпНроЯрпБ, рокро╛роЩрпНроХрпН роЕроХрпНроХро╡рпБрогрпНроЯрпН" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="service-price">роиро┐ро▓рпИропро╛рой роХроЯрпНроЯрогроорпН (тВ╣)</label>
                                <input type="number" id="service-price" placeholder="0" min="0" step="100">
                            </div>
                            
                            <div class="btn-group">
                                <button type="submit" class="primary-btn" id="service-submit-btn">
                                    тЮХ роЪрпЗро╡рпИропрпИ роЪрпЗро░рпНроХрпНроХ
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <div class="form-section" style="margin-top: 30px;">
                        <h3>роЪрпЗро╡рпИроХро│ро┐ройрпН рокроЯрпНроЯро┐ропро▓рпН</h3>
                        <div id="services-management">
                            <!-- роЪрпЗро╡рпИроХро│рпН рокроЯрпНроЯро┐ропро▓рпН роЗроЩрпНроХрпЗ роХро╛роЯрпНроЯрокрпНрокроЯрпБроорпН -->
                        </div>
                    </div>
                </div>
                
                <div class="reports-container" id="reports-tab">
                    <h2 style="color: #2c3e50; margin-top: 0;">роЕро▒ро┐роХрпНроХрпИроХро│рпН</h2>
                    
                    <div class="form-section">
                        <h3>роЕро▒ро┐роХрпНроХрпИ роЕро│ро╡рпБроХрпЛро▓рпНроХро│рпН</h3>
                        
                        <div class="form-group">
                            <label for="report-type">роЕро▒ро┐роХрпНроХрпИ ро╡роХрпИ</label>
                            <select id="report-type">
                                <option value="debtors">роХроЯройро╛ро│ро┐роХро│рпН роЕро▒ро┐роХрпНроХрпИ</option>
                                <option value="payments">роХроЯрпНроЯрогроЩрпНроХро│рпН роЕро▒ро┐роХрпНроХрпИ</option>
                                <option value="customers">ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН роЕро▒ро┐роХрпНроХрпИ</option>
                                <option value="services">роЪрпЗро╡рпИ ро╡ро╛ро░ро┐ропро╛рой роЕро▒ро┐роХрпНроХрпИ</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>родрпЗродро┐ ро╡ро░роорпНрокрпБ</label>
                            <div style="display: flex; gap: 15px;">
                                <input type="date" id="report-from" style="flex: 1;">
                                <span style="align-self: center;">роорпБродро▓рпН</span>
                                <input type="date" id="report-to" style="flex: 1;">
                            </div>
                        </div>
                        
                        <div class="btn-group">
                            <button class="primary-btn" onclick="generateReport()">
                                ЁЯУК роЕро▒ро┐роХрпНроХрпИ роЙро░рпБро╡ро╛роХрпНроХрпБроХ
                            </button>
                            <button class="print-btn" onclick="printReport()">
                                ЁЯЦия╕П роЕроЪрпНроЪро┐роЯрпБроХ
                            </button>
                        </div>
                    </div>
                    
                    <div id="report-output" style="margin-top: 30px;">
                        <!-- роЕро▒ро┐роХрпНроХрпИ роЗроЩрпНроХрпЗ роХро╛роЯрпНроЯрокрпНрокроЯрпБроорпН -->
                    </div>
                </div>
            </div>
            
            <div class="content-area">
                <div id="customers-tab">
                    <h2 style="color: #2c3e50; margin-top: 0;">
                        ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН рокроЯрпНроЯро┐ропро▓рпН
                        <span style="float: right; color: #3498db; font-size: 16px;" id="customer-count">0 ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН</span>
                    </h2>
                    
                    <div class="search-filter no-print">
                        <input type="text" id="search" placeholder="ЁЯФН рокрпЖропро░рпН, родрпКро▓рпИрокрпЗроЪро┐ роОрогрпН роЕро▓рпНро▓родрпБ роЖродро╛ро░ро╛ро▓рпН родрпЗроЯрпБроХ...">
                        <select id="filter-status">
                            <option value="all">роЕройрпИродрпНродрпБроорпН</option>
                            <option value="active">роЪрпЖропро▓ро┐ро▓рпН</option>
                            <option value="debtors">роХроЯройро╛ро│ро┐роХро│рпН</option>
                            <option value="cleared">роорпБро┤рпБро╡родрпБроорпН роЪрпЖро▓рпБродрпНродро┐ропро╡ро░рпНроХро│рпН</option>
                        </select>
                        <button class="outline-btn" onclick="clearFilters()" style="padding: 14px 28px;">
                            родрпЖро░ро┐ро╡рпБроХро│рпИ роирпАроХрпНроХрпБ
                        </button>
                    </div>
                    
                    <div id="customers-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>роХрпБро▒ро┐ропрпАроЯрпБ</th>
                                    <th>ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН</th>
                                    <th>родрпКроЯро░рпНрокрпБ</th>
                                    <th>роЪрпЗро╡рпИроХро│рпН</th>
                                    <th>роорпКродрпНрод родрпКроХрпИ</th>
                                    <th>роЪрпЖро▓рпБродрпНродро┐ропродрпБ</th>
                                    <th>рокрпЗро▓ройрпНро╕рпН</th>
                                    <th class="no-print">роЪрпЖропро▓рпНроХро│рпН</th>
                                </tr>
                            </thead>
                            <tbody id="customers-table-body">
                                <!-- ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН роЗроЩрпНроХрпЗ роХро╛роЯрпНроЯрокрпНрокроЯрпБроорпН -->
                            </tbody>
                        </table>
                        <div id="no-data" class="no-data">
                            <div class="no-data-icon">ЁЯСд</div>
                            <h3>ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН роЗро▓рпНро▓рпИ</h3>
                            <p>роорпБродро▓рпН ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпИроЪрпН роЪрпЗро░рпНроХрпНроХ родрпКроЯроЩрпНроХрпБроХ!</p>
                        </div>
                    </div>
                </div>
                
                <div class="no-print" style="margin-top: 40px; text-align: center;">
                    <button class="print-btn" onclick="printCustomerList()">
                        ЁЯЦия╕П ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН рокроЯрпНроЯро┐ропро▓рпИ роЕроЪрпНроЪро┐роЯрпБроХ
                    </button>
                    <button class="warning-btn" onclick="exportData()" style="margin-left: 15px;">
                        ЁЯУе родро░ро╡рпБроХро│рпИ роПро▒рпНро▒рпБроородро┐ роЪрпЖропрпНроХ
                    </button>
                    <button class="secondary-btn" onclick="importData()" style="margin-left: 15px;">
                        ЁЯУд родро░ро╡рпБроХро│рпИ роЗро▒роХрпНроХрпБроородро┐ роЪрпЖропрпНроХ
                    </button>
                </div>
            </div>
        </div>
        
        <footer class="no-print">
            <p>┬й 2023 родро╛ро╕рпН рокрпКродрпБ роЪрпЗро╡рпИ роорпИропроорпН - ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН роорпЗро▓ро╛рогрпНроорпИ роорпЖройрпНрокрпКро░рпБро│рпН | родрпВродрпНродрпБроХрпНроХрпБроЯро┐</p>
            <p>рокродро┐рокрпНрокрпБро░ро┐роорпИ ┬й родро╛ро╕рпН рокрпКродрпБ роЪрпЗро╡рпИ роорпИропроорпН | dhasscsc@gmail.com</p>
        </footer>
    </div>

    <!-- роХроЯрпНроЯрог ро╡ро░ро▓ро╛ро▒рпБ рооро╛роЯро▓рпН -->
    <div class="modal" id="payment-history-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
        <div style="background: white; padding: 40px; border-radius: 20px; max-width: 800px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="margin: 0; color: #2c3e50;">роХроЯрпНроЯрог ро╡ро░ро▓ро╛ро▒рпБ</h2>
                <button onclick="closePaymentHistory()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #2c3e50;">├Ч</button>
            </div>
            <div id="payment-history-content">
                <!-- роХроЯрпНроЯрог ро╡ро░ро▓ро╛ро▒рпБ роЗроЩрпНроХрпЗ роХро╛роЯрпНроЯрокрпНрокроЯрпБроорпН -->
            </div>
        </div>
    </div>

    <script>
        // родро░ро╡рпБ роЪрпЗрооро┐рокрпНрокрпБ
        let customers = JSON.parse(localStorage.getItem('dassCustomers')) || [];
        let services = JSON.parse(localStorage.getItem('dassServices')) || [];
        let payments = JSON.parse(localStorage.getItem('dassPayments')) || [];
        let editCustomerId = null;
        let editServiceId = null;

        // рооро╛родро┐ро░ро┐ роЪрпЗро╡рпИроХро│рпН (роорпБродро▓рпН роорпБро▒рпИ рокропройрпНрокроЯрпБродрпНродрпБроорпН рокрпЛродрпБ)
        if (services.length === 0) {
            services = [
                { id: 1, name: "роЖродро╛ро░рпН роХро╛ро░рпНроЯрпБ", price: 100 },
                { id: 2, name: "рокро╛роЩрпНроХрпН роЕроХрпНроХро╡рпБрогрпНроЯрпН", price: 200 },
                { id: 3, name: "рокро╛ро╕рпНрокрпЛро░рпНроЯрпН", price: 1500 },
                { id: 4, name: "рокро╛ройрпН роХро╛ро░рпНроЯрпБ", price: 100 },
                { id: 5, name: "ро╡ро╛роХрой ро▓рпИроЪрпЖройрпНро╕рпН", price: 500 },
                { id: 6, name: "ро╡ро╛роХрой рокродро┐ро╡рпБ", price: 1000 },
                { id: 7, name: "ро░рпЗро╖ройрпН роХро╛ро░рпНроЯрпБ", price: 50 },
                { id: 8, name: "роХрпБроЯрпБроорпНрок роЕроЯрпНроЯрпИ", price: 100 },
                { id: 9, name: "роЪроорпНрокро│ роЪро╛ройрпНро▒ро┐родро┤рпН", price: 200 },
                { id: 10, name: "ро╡ро╛роХрпНроХро╛ро│ро░рпН роЕроЯрпНроЯрпИ", price: 50 }
            ];
            saveServices();
        }

        // DOM роЙро▒рпБрокрпНрокрпБроХро│рпН
        const customerForm = document.getElementById('customer-form');
        const paymentForm = document.getElementById('payment-form');
        const serviceForm = document.getElementById('service-form');
        const serviceSubmitBtn = document.getElementById('service-submit-btn');
        const servicesList = document.getElementById('services-list');
        const paymentCustomerSelect = document.getElementById('payment-customer');
        const customersTableBody = document.getElementById('customers-table-body');
        const noDataElement = document.getElementById('no-data');
        const searchInput = document.getElementById('search');
        const filterStatusSelect = document.getElementById('filter-status');

        // родрпКроЯроХрпНроХродрпНродро┐ро▓рпН роЕроорпИроХрпНроХ
        document.getElementById('payment-date').valueAsDate = new Date();
        updateDashboard();
        renderCustomers();
        renderServicesCheckboxes();
        updatePaymentCustomerSelect();

        // ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН рокроЯро┐ро╡роорпН
        customerForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const selectedServices = Array.from(document.querySelectorAll('#services-list input[type="checkbox"]:checked'))
                .map(checkbox => checkbox.value);
            
            const totalAmount = parseInt(document.getElementById('total-amount').value) || 0;
            const paidAmount = parseInt(document.getElementById('paid-amount').value) || 0;
            const balanceAmount = totalAmount - paidAmount;
            
            const customer = {
                id: editCustomerId ? editCustomerId : 'DASS' + Date.now().toString().slice(-6),
                name: document.getElementById('customer-name').value,
                phone: document.getElementById('customer-phone').value,
                phone2: document.getElementById('customer-phone2').value,
                address: document.getElementById('customer-address').value,
                aadhar: document.getElementById('customer-aadhar').value,
                services: selectedServices,
                totalAmount: totalAmount,
                paidAmount: paidAmount,
                balanceAmount: balanceAmount,
                notes: document.getElementById('customer-notes').value,
                status: balanceAmount > 0 ? 'debtor' : 'cleared',
                registrationDate: new Date().toISOString().split('T')[0],
                lastPaymentDate: paidAmount > 0 ? new Date().toISOString().split('T')[0] : null
            };
            
            if (editCustomerId) {
                // рокрпБродрпБрокрпНрокро┐роХрпНроХ
                const index = customers.findIndex(c => c.id === editCustomerId);
                if (index !== -1) customers[index] = customer;
                editCustomerId = null;
                document.getElementById('submit-btn').style.display = 'block';
                document.getElementById('update-btn').style.display = 'none';
                document.getElementById('cancel-btn').style.display = 'none';
            } else {
                // рокрпБродро┐роп ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН
                customers.unshift(customer);
            }
            
            saveCustomers();
            renderCustomers();
            updateDashboard();
            updatePaymentCustomerSelect();
            resetCustomerForm();
            
            alert(editCustomerId ? 'ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН родроХро╡ро▓рпНроХро│рпН рокрпБродрпБрокрпНрокро┐роХрпНроХрокрпНрокроЯрпНроЯрой!' : 'ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ роЪрпЗро░рпНроХрпНроХрокрпНрокроЯрпНроЯро╛ро░рпН!');
        });

        // роХроЯрпНроЯрог рокроЯро┐ро╡роорпН
        paymentForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const customerId = document.getElementById('payment-customer').value;
            const customer = customers.find(c => c.id === customerId);
            
            if (!customer) {
                alert('ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН родроХро╡ро▓рпН роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ!');
                return;
            }
            
            const payment = {
                id: 'PAY' + Date.now().toString().slice(-6),
                customerId: customerId,
                customerName: customer.name,
                date: document.getElementById('payment-date').value,
                amount: parseInt(document.getElementById('payment-amount').value) || 0,
                mode: document.getElementById('payment-mode').value,
                reference: document.getElementById('payment-reference').value,
                notes: document.getElementById('payment-notes').value,
                timestamp: new Date().toISOString()
            };
            
            // ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН рокрпЗро▓ройрпНро╕рпН рокрпБродрпБрокрпНрокро┐роХрпНроХ
            customer.paidAmount += payment.amount;
            customer.balanceAmount = customer.totalAmount - customer.paidAmount;
            customer.status = customer.balanceAmount > 0 ? 'debtor' : 'cleared';
            customer.lastPaymentDate = payment.date;
            
            payments.unshift(payment);
            
            saveCustomers();
            savePayments();
            renderCustomers();
            updateDashboard();
            updatePaymentCustomerSelect();
            resetPaymentForm();
            
            // рокрпЗро▓ройрпНро╕рпН родроХро╡ро▓рпН рокрпБродрпБрокрпНрокро┐роХрпНроХ
            showCustomerBalance(customerId);
            
            alert('роХроЯрпНроЯрогроорпН ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ рокродро┐ро╡рпБ роЪрпЖропрпНропрокрпНрокроЯрпНроЯродрпБ!');
        });

        // роЪрпЗро╡рпИ рокроЯро┐ро╡роорпН
        serviceForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (editServiceId) {
                // роЪрпЗро╡рпИропрпИ рокрпБродрпБрокрпНрокро┐роХрпНроХ
                updateService(editServiceId);
            } else {
                // рокрпБродро┐роп роЪрпЗро╡рпИ роЪрпЗро░рпНроХрпНроХ
                addNewService();
            }
        });

        // рокрпБродро┐роп роЪрпЗро╡рпИ роЪрпЗро░рпНроХрпНроХ
        function addNewService() {
            const service = {
                id: Date.now(),
                name: document.getElementById('service-name').value,
                price: parseInt(document.getElementById('service-price').value) || 0
            };
            
            services.push(service);
            saveServices();
            renderServicesCheckboxes();
            renderServicesManagement();
            resetServiceForm();
            
            alert('роЪрпЗро╡рпИ ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ роЪрпЗро░рпНроХрпНроХрокрпНрокроЯрпНроЯродрпБ!');
        }

        // ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпИ роХро╛роЯрпНроЯрпБ
        function renderCustomers(filter = '', statusFilter = 'all') {
            let filteredCustomers = customers;
            
            // родрпЗроЯро▓рпН ро╡роЯро┐роХроЯрпНроЯро▓рпН
            if (filter) {
                const searchTerm = filter.toLowerCase();
                filteredCustomers = filteredCustomers.filter(c => 
                    c.name.toLowerCase().includes(searchTerm) ||
                    c.phone.includes(searchTerm) ||
                    c.aadhar.includes(searchTerm) ||
                    c.id.toLowerCase().includes(searchTerm)
                );
            }
            
            // роиро┐ро▓рпИ ро╡роЯро┐роХроЯрпНроЯро▓рпН
            if (statusFilter !== 'all') {
                if (statusFilter === 'debtors') {
                    filteredCustomers = filteredCustomers.filter(c => c.balanceAmount > 0);
                } else if (statusFilter === 'cleared') {
                    filteredCustomers = filteredCustomers.filter(c => c.balanceAmount <= 0);
                } else if (statusFilter === 'active') {
                    filteredCustomers = filteredCustomers.filter(c => c.services.length > 0);
                }
            }
            
            if (filteredCustomers.length === 0) {
                customersTableBody.innerHTML = '';
                noDataElement.style.display = 'block';
                document.getElementById('customer-count').textContent = '0 ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН';
                return;
            }
            
            noDataElement.style.display = 'none';
            document.getElementById('customer-count').textContent = `${filteredCustomers.length} ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН`;
            
            let tableHTML = '';
            
            filteredCustomers.forEach(customer => {
                const serviceTags = customer.services.slice(0, 3).map(service => 
                    `<span class="service-tag">${service}</span>`
                ).join('');
                
                const moreServices = customer.services.length > 3 ? 
                    `<span class="service-tag">+${customer.services.length - 3} роорпЗро▓рпБроорпН</span>` : '';
                
                const debtClass = customer.balanceAmount > 10000 ? 'debt-high' : 
                                 customer.balanceAmount > 0 ? 'debt-medium' : '';
                
                tableHTML += `
                <tr class="${debtClass}">
                    <td>
                        <span class="customer-id">${customer.id}</span><br>
                        <small style="color: #6c757d;">${formatDate(customer.registrationDate)}</small>
                    </td>
                    <td>
                        <div class="customer-name">${customer.name}</div>
                        <small style="color: #6c757d;">${customer.address.split(',')[0]}</small>
                        ${customer.aadhar ? `<br><small style="color: #6c757d;">роЖродро╛ро░рпН: ${customer.aadhar}</small>` : ''}
                    </td>
                    <td>
                        <div class="customer-phone">${customer.phone}</div>
                        ${customer.phone2 ? `<div style="color: #6c757d; font-size: 13px;">${customer.phone2}</div>` : ''}
                    </td>
                    <td>
                        <div class="service-tags">
                            ${serviceTags}${moreServices}
                        </div>
                    </td>
                    <td>
                        <strong>тВ╣${customer.totalAmount.toLocaleString('en-IN')}</strong>
                    </td>
                    <td>
                        <span class="paid-amount">тВ╣${customer.paidAmount.toLocaleString('en-IN')}</span>
                    </td>
                    <td>
                        <span class="${customer.balanceAmount > 0 ? 'debt-amount' : 'paid-amount'}">
                            тВ╣${customer.balanceAmount.toLocaleString('en-IN')}
                        </span>
                    </td>
                    <td class="no-print">
                        <div class="action-buttons">
                            <button class="small-btn outline-btn" onclick="viewCustomer('${customer.id}')">
                                ЁЯСБя╕П
                            </button>
                            <button class="small-btn outline-btn" onclick="editCustomer('${customer.id}')">
                                тЬПя╕П
                            </button>
                            <button class="small-btn outline-btn" onclick="viewPaymentHistory('${customer.id}')" title="роХроЯрпНроЯрог ро╡ро░ро▓ро╛ро▒рпБ">
                                ЁЯТ░
                            </button>
                            <button class="small-btn danger-btn" onclick="deleteCustomer('${customer.id}')">
                                ЁЯЧСя╕П
                            </button>
                        </div>
                    </td>
                </tr>
                `;
            });
            
            customersTableBody.innerHTML = tableHTML;
        }

        // ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпИ рокро╛ро░рпН
        function viewCustomer(id) {
            const customer = customers.find(c => c.id === id);
            if (!customer) return;
            
            const customerPayments = payments.filter(p => p.customerId === id);
            const totalPaid = customerPayments.reduce((sum, p) => sum + p.amount, 0);
            
            let detailsHTML = `
                <div class="report-card">
                    <h3 style="color: #2c3e50; margin-top: 0;">ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН ро╡ро┐ро╡ро░роЩрпНроХро│рпН</h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <p><strong>роХрпБро▒ро┐ропрпАроЯрпБ:</strong> ${customer.id}</p>
                            <p><strong>рокрпЖропро░рпН:</strong> ${customer.name}</p>
                            <p><strong>роорпБродройрпНроорпИ родрпКро▓рпИрокрпЗроЪро┐:</strong> ${customer.phone}</p>
                            ${customer.phone2 ? `<p><strong>рооро╛ро▒рпНро▒рпБ родрпКро▓рпИрокрпЗроЪро┐:</strong> ${customer.phone2}</p>` : ''}
                            ${customer.aadhar ? `<p><strong>роЖродро╛ро░рпН роОрогрпН:</strong> ${customer.aadhar}</p>` : ''}
                        </div>
                        <div>
                            <p><strong>рокродро┐ро╡рпБ родрпЗродро┐:</strong> ${formatDate(customer.registrationDate)}</p>
                            <p><strong>роХроЯрпИроЪро┐ роХроЯрпНроЯрог родрпЗродро┐:</strong> ${customer.lastPaymentDate ? formatDate(customer.lastPaymentDate) : 'роЗро▓рпНро▓рпИ'}</p>
                            <p><strong>роиро┐ро▓рпИ:</strong> <span class="status-badge ${customer.status === 'cleared' ? 'status-active' : 'status-pending'}">${customer.status === 'cleared' ? 'роорпБро┤рпБро╡родрпБроорпН роЪрпЖро▓рпБродрпНродро┐ропродрпБ' : 'роХроЯройро╛ро│ро┐'}</span></p>
                        </div>
                    </div>
                    
                    <p><strong>роорпБроХро╡ро░ро┐:</strong><br>${customer.address}</p>
                    
                    <div style="margin-top: 20px;">
                        <h4>роЪрпЗро╡рпИроХро│рпН:</h4>
                        <div class="service-tags">
                            ${customer.services.map(service => `<span class="service-tag">${service}</span>`).join('')}
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 25px; text-align: center;">
                        <div style="padding: 15px; background: #f8f9fa; border-radius: 10px;">
                            <div style="font-size: 14px; color: #6c757d;">роорпКродрпНрод родрпКроХрпИ</div>
                            <div style="font-size: 24px; font-weight: 700; color: #2c3e50;">тВ╣${customer.totalAmount.toLocaleString('en-IN')}</div>
                        </div>
                        <div style="padding: 15px; background: #f8f9fa; border-radius: 10px;">
                            <div style="font-size: 14px; color: #6c757d;">роЪрпЖро▓рпБродрпНродро┐ропродрпБ</div>
                            <div style="font-size: 24px; font-weight: 700; color: #27ae60;">тВ╣${customer.paidAmount.toLocaleString('en-IN')}</div>
                        </div>
                        <div style="padding: 15px; background: #f8f9fa; border-radius: 10px;">
                            <div style="font-size: 14px; color: #6c757d;">рокрпЗро▓ройрпНро╕рпН</div>
                            <div style="font-size: 24px; font-weight: 700; color: ${customer.balanceAmount > 0 ? '#e74c3c' : '#27ae60'};">тВ╣${customer.balanceAmount.toLocaleString('en-IN')}</div>
                        </div>
                    </div>
                    
                    ${customer.notes ? `<p style="margin-top: 20px;"><strong>роХрпБро▒ро┐рокрпНрокрпБроХро│рпН:</strong> ${customer.notes}</p>` : ''}
                    
                    <div style="margin-top: 30px;">
                        <h4>роХроЯрпНроЯрог ро╡ро░ро▓ро╛ро▒рпБ (${customerPayments.length} рокродро┐ро╡рпБроХро│рпН):</h4>
                        ${customerPayments.length > 0 ? `
                            <div class="payment-history">
                                ${customerPayments.map(payment => `
                                    <div class="payment-item">
                                        <div>
                                            <strong>${formatDate(payment.date)}</strong><br>
                                            <small>${payment.mode} | ${payment.reference || 'ро░роЪрпАродрпБ роЗро▓рпНро▓рпИ'}</small>
                                        </div>
                                        <div style="color: #27ae60; font-weight: 700;">тВ╣${payment.amount.toLocaleString('en-IN')}</div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : '<p>роХроЯрпНроЯрог ро╡ро░ро▓ро╛ро▒рпБ роЗро▓рпНро▓рпИ</p>'}
                    </div>
                    
                    <div style="margin-top: 30px; text-align: center;">
                        <button class="primary-btn" onclick="editCustomer('${customer.id}')">
                            тЬПя╕П роЗроирпНрод ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпИ родро┐ро░рпБродрпНродрпБ
                        </button>
                        <button class="outline-btn" onclick="addPaymentForCustomer('${customer.id}')" style="margin-left: 15px;">
                            ЁЯТ░ роЗроирпНрод ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпБроХрпНроХрпБ роХроЯрпНроЯрогроорпН роЪрпЗро░рпНроХрпНроХ
                        </button>
                    </div>
                </div>
            `;
            
            // рооро╛роЯро▓рпН роХро╛роЯрпНроЯ
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.7);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
            `;
            
            modal.innerHTML = `
                <div style="background: white; padding: 40px; border-radius: 20px; max-width: 900px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2 style="margin: 0; color: #2c3e50;">ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН ро╡ро┐ро╡ро░роЩрпНроХро│рпН</h2>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #2c3e50;">├Ч</button>
                    </div>
                    ${detailsHTML}
                    <div style="margin-top: 30px; text-align: center;">
                        <button class="print-btn" onclick="printCustomerDetails('${customer.id}')">
                            ЁЯЦия╕П роЗроирпНрод ро╡ро┐ро╡ро░роЩрпНроХро│рпИ роЕроЪрпНроЪро┐роЯрпБроХ
                        </button>
                        <button class="outline-btn" onclick="this.parentElement.parentElement.parentElement.remove()" style="margin-left: 15px;">
                            роорпВроЯрпБроХ
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпИ родро┐ро░рпБродрпНродрпБ
        function editCustomer(id) {
            const customer = customers.find(c => c.id === id);
            if (!customer) return;
            
            document.getElementById('customer-name').value = customer.name;
            document.getElementById('customer-phone').value = customer.phone;
            document.getElementById('customer-phone2').value = customer.phone2 || '';
            document.getElementById('customer-address').value = customer.address;
            document.getElementById('customer-aadhar').value = customer.aadhar || '';
            document.getElementById('total-amount').value = customer.totalAmount;
            document.getElementById('paid-amount').value = customer.paidAmount;
            document.getElementById('customer-notes').value = customer.notes || '';
            document.getElementById('customer-id').value = customer.id;
            
            // роЪрпЗро╡рпИроХро│рпИ родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХ
            document.querySelectorAll('#services-list input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = customer.services.includes(checkbox.value);
            });
            
            editCustomerId = customer.id;
            document.getElementById('submit-btn').style.display = 'none';
            document.getElementById('update-btn').style.display = 'block';
            document.getElementById('cancel-btn').style.display = 'block';
            
            // ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН родро╛ро╡ро▓рпБроХрпНроХрпБ роЪрпЖро▓рпН
            switchTab('customer');
            document.querySelector('.sidebar').scrollIntoView({ behavior: 'smooth' });
        }

        // ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпБроХрпНроХрпБ роХроЯрпНроЯрогроорпН роЪрпЗро░рпНроХрпНроХ
        function addPaymentForCustomer(id) {
            const customer = customers.find(c => c.id === id);
            if (!customer) return;
            
            // рооро╛роЯро▓рпИ роорпВроЯрпБ
            document.querySelectorAll('div[style*="position: fixed; top: 0; left: 0; width: 100%"]').forEach(modal => modal.remove());
            
            // роХроЯрпНроЯрог родро╛ро╡ро▓рпБроХрпНроХрпБ роЪрпЖро▓рпН
            switchTab('payment');
            document.getElementById('payment-customer').value = id;
            document.getElementById('payment-amount').focus();
            
            // рокрпЗро▓ройрпНро╕рпН родроХро╡ро▓рпН роХро╛роЯрпНроЯ
            showCustomerBalance(id);
        }

        // ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпИ роирпАроХрпНроХрпБ
        function deleteCustomer(id) {
            const customer = customers.find(c => c.id === id);
            if (!customer) return;
            
            const customerPayments = payments.filter(p => p.customerId === id);
            
            let message = `ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН "${customer.name}" (${customer.id}) роР роиро┐роЪрпНроЪропрооро╛роХ роирпАроХрпНроХ ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒рпАро░рпНроХро│ро╛?`;
            
            if (customerPayments.length > 0) {
                message += `\n\nроХро╡ройро┐роХрпНроХ: роЗроирпНрод ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпБроХрпНроХрпБ ${customerPayments.length} роХроЯрпНроЯрог рокродро┐ро╡рпБроХро│рпН роЙро│рпНро│рой. роЕро╡рпИропрпБроорпН роирпАроХрпНроХрокрпНрокроЯрпБроорпН.`;
            }
            
            if (!confirm(message)) return;
            
            // ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН рооро▒рпНро▒рпБроорпН роХроЯрпНроЯрогроЩрпНроХро│рпИ роирпАроХрпНроХрпБ
            customers = customers.filter(c => c.id !== id);
            payments = payments.filter(p => p.customerId !== id);
            
            saveCustomers();
            savePayments();
            renderCustomers();
            updateDashboard();
            updatePaymentCustomerSelect();
            
            alert('ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ роирпАроХрпНроХрокрпНрокроЯрпНроЯро╛ро░рпН!');
        }

        // роХроЯрпНроЯрог ро╡ро░ро▓ро╛ро▒рпБ роХро╛роЯрпНроЯрпБ
        function viewPaymentHistory(id) {
            const customer = customers.find(c => c.id === id);
            const customerPayments = payments.filter(p => p.customerId === id).sort((a, b) => new Date(b.date) - new Date(a.date));
            
            if (!customer) return;
            
            let historyHTML = `
                <h3 style="color: #2c3e50;">${customer.name} - роХроЯрпНроЯрог ро╡ро░ро▓ро╛ро▒рпБ</h3>
                <p><strong>роХрпБро▒ро┐ропрпАроЯрпБ:</strong> ${customer.id} | <strong>рокрпЗро▓ройрпНро╕рпН:</strong> тВ╣${customer.balanceAmount.toLocaleString('en-IN')}</p>
                
                ${customerPayments.length > 0 ? `
                    <table>
                        <thead>
                            <tr>
                                <th>родрпЗродро┐</th>
                                <th>ро░роЪрпАродрпБ</th>
                                <th>роорпБро▒рпИ</th>
                                <th>родрпКроХрпИ</th>
                                <th>роХрпБро▒ро┐рокрпНрокрпБроХро│рпН</th>
                                <th class="no-print">роЪрпЖропро▓рпНроХро│рпН</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${customerPayments.map(payment => `
                                <tr>
                                    <td>${formatDate(payment.date)}</td>
                                    <td>${payment.reference || '-'}</td>
                                    <td>${getPaymentModeText(payment.mode)}</td>
                                    <td style="color: #27ae60; font-weight: 700;">тВ╣${payment.amount.toLocaleString('en-IN')}</td>
                                    <td>${payment.notes || '-'}</td>
                                    <td class="no-print">
                                        <div class="action-buttons">
                                            <button class="small-btn outline-btn" onclick="editPayment('${payment.id}')" title="роХроЯрпНроЯрогродрпНродрпИ родро┐ро░рпБродрпНродрпБ">
                                                тЬПя╕П
                                            </button>
                                            <button class="small-btn danger-btn" onclick="deletePayment('${payment.id}', '${customer.id}')" title="роХроЯрпНроЯрогродрпНродрпИ роирпАроХрпНроХрпБ">
                                                ЁЯЧСя╕П
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    <p style="margin-top: 20px; text-align: right; font-weight: 700;">
                        роорпКродрпНрод роХроЯрпНроЯрогроорпН: тВ╣${customerPayments.reduce((sum, p) => sum + p.amount, 0).toLocaleString('en-IN')}
                    </p>
                ` : '<div class="no-data"><p>роХроЯрпНроЯрог ро╡ро░ро▓ро╛ро▒рпБ роЗро▓рпНро▓рпИ</p></div>'}
                
                <div style="margin-top: 30px; text-align: center;">
                    <button class="primary-btn" onclick="addPaymentForCustomer('${id}'); closePaymentHistory()">
                        ЁЯТ░ рокрпБродро┐роп роХроЯрпНроЯрогроорпН роЪрпЗро░рпНроХрпНроХ
                    </button>
                    <button class="outline-btn" onclick="closePaymentHistory()" style="margin-left: 15px;">
                        роорпВроЯрпБроХ
                    </button>
                </div>
            `;
            
            document.getElementById('payment-history-content').innerHTML = historyHTML;
            document.getElementById('payment-history-modal').style.display = 'flex';
        }

        // роХроЯрпНроЯрог ро╡ро░ро▓ро╛ро▒рпБ роорпВроЯрпБ
        function closePaymentHistory() {
            document.getElementById('payment-history-modal').style.display = 'none';
        }

        // роХроЯрпНроЯрогродрпНродрпИ родро┐ро░рпБродрпНродрпБ
        function editPayment(paymentId) {
            const payment = payments.find(p => p.id === paymentId);
            if (!payment) return;
            
            const customer = customers.find(c => c.id === payment.customerId);
            if (!customer) return;
            
            // роХроЯрпНроЯрог родро┐ро░рпБродрпНродроорпН рокроЯро┐ро╡роорпН
            const editPaymentHTML = `
                <div style="background: #f8f9fa; padding: 30px; border-radius: 15px; margin-top: 20px; border: 2px solid #dee2e6;">
                    <h4 style="margin-top: 0; color: #2c3e50;">роХроЯрпНроЯрогродрпНродрпИ родро┐ро░рпБродрпНродрпБроХ</h4>
                    <form id="edit-payment-form">
                        <input type="hidden" id="edit-payment-id" value="${payment.id}">
                        <input type="hidden" id="edit-customer-id" value="${customer.id}">
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                            <div>
                                <p><strong>ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН:</strong> ${customer.name}</p>
                                <p><strong>роорпБроирпНродрпИроп родрпКроХрпИ:</strong> тВ╣${payment.amount.toLocaleString('en-IN')}</p>
                            </div>
                            <div>
                                <p><strong>роорпКродрпНрод родрпКроХрпИ:</strong> тВ╣${customer.totalAmount.toLocaleString('en-IN')}</p>
                                <p><strong>родро▒рпНрокрпЛродрпИроп рокрпЗро▓ройрпНро╕рпН:</strong> тВ╣${customer.balanceAmount.toLocaleString('en-IN')}</p>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-payment-date" class="required">роХроЯрпНроЯрог родрпЗродро┐</label>
                            <input type="date" id="edit-payment-date" value="${payment.date}" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-payment-amount" class="required">роХроЯрпНроЯрог родрпКроХрпИ (тВ╣)</label>
                            <input type="number" id="edit-payment-amount" value="${payment.amount}" min="0" step="100" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-payment-mode">роХроЯрпНроЯрог роорпБро▒рпИ</label>
                            <select id="edit-payment-mode">
                                <option value="cash" ${payment.mode === 'cash' ? 'selected' : ''}>рокрогроорпН</option>
                                <option value="online" ${payment.mode === 'online' ? 'selected' : ''}>роЖройрпНро▓рпИройрпН</option>
                                <option value="cheque" ${payment.mode === 'cheque' ? 'selected' : ''}>роЪрпЖроХрпН</option>
                                <option value="upi" ${payment.mode === 'upi' ? 'selected' : ''}>UPI</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-payment-reference">ро░роЪрпАродрпБ роОрогрпН / роХрпБро▒ро┐рокрпНрокрпБ</label>
                            <input type="text" id="edit-payment-reference" value="${payment.reference || ''}" placeholder="ро░роЪрпАродрпБ роОрогрпН роЕро▓рпНро▓родрпБ роХрпБро▒ро┐рокрпНрокрпБ">
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-payment-notes">роХрпБро▒ро┐рокрпНрокрпБроХро│рпН</label>
                            <textarea id="edit-payment-notes" rows="2" placeholder="роХрпВроЯрпБродро▓рпН ро╡ро┐ро╡ро░роЩрпНроХро│рпН">${payment.notes || ''}</textarea>
                        </div>
                        
                        <div class="btn-group" style="margin-top: 20px;">
                            <button type="button" class="primary-btn" onclick="updatePayment()">
                                ЁЯТ╛ роХроЯрпНроЯрогродрпНродрпИ рокрпБродрпБрокрпНрокро┐роХрпНроХ
                            </button>
                            <button type="button" class="outline-btn" onclick="cancelEditPayment()">
                                тЭМ ро░родрпНродрпБ роЪрпЖропрпНроХ
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            // рооро╛роЯро▓ро┐ро▓рпН роХроЯрпНроЯрог родро┐ро░рпБродрпНродроорпН рокроЯро┐ро╡родрпНродрпИ роХро╛роЯрпНроЯрпБ
            document.getElementById('payment-history-content').innerHTML = editPaymentHTML;
        }

        // роХроЯрпНроЯрогродрпНродрпИ рокрпБродрпБрокрпНрокро┐роХрпНроХ
        function updatePayment() {
            const paymentId = document.getElementById('edit-payment-id').value;
            const customerId = document.getElementById('edit-customer-id').value;
            
            const payment = payments.find(p => p.id === paymentId);
            const customer = customers.find(c => c.id === customerId);
            
            if (!payment || !customer) {
                alert('родро░ро╡рпБ роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ!');
                return;
            }
            
            const oldAmount = payment.amount;
            const newAmount = parseInt(document.getElementById('edit-payment-amount').value) || 0;
            const difference = newAmount - oldAmount;
            
            // роХроЯрпНроЯрог ро╡ро┐ро╡ро░роЩрпНроХро│рпИ рокрпБродрпБрокрпНрокро┐роХрпНроХро╡рпБроорпН
            payment.date = document.getElementById('edit-payment-date').value;
            payment.amount = newAmount;
            payment.mode = document.getElementById('edit-payment-mode').value;
            payment.reference = document.getElementById('edit-payment-reference').value;
            payment.notes = document.getElementById('edit-payment-notes').value;
            
            // ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН рокрпЗро▓ройрпНро╕рпИ рокрпБродрпБрокрпНрокро┐роХрпНроХро╡рпБроорпН
            customer.paidAmount += difference;
            customer.balanceAmount = customer.totalAmount - customer.paidAmount;
            customer.status = customer.balanceAmount > 0 ? 'debtor' : 'cleared';
            customer.lastPaymentDate = payment.date;
            
            // родро░ро╡рпБроХро│рпИ роЪрпЗрооро┐роХрпНроХро╡рпБроорпН
            saveCustomers();
            savePayments();
            
            // роХроЯрпНроЯрог ро╡ро░ро▓ро╛ро▒рпНро▒рпИ роорпАрогрпНроЯрпБроорпН роХро╛роЯрпНроЯрпБ
            viewPaymentHistory(customerId);
            
            alert('роХроЯрпНроЯрогроорпН ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ рокрпБродрпБрокрпНрокро┐роХрпНроХрокрпНрокроЯрпНроЯродрпБ!');
        }

        // роХроЯрпНроЯрог родро┐ро░рпБродрпНродродрпНродрпИ ро░родрпНродрпБ роЪрпЖропрпН
        function cancelEditPayment() {
            const customerId = document.getElementById('edit-customer-id').value;
            viewPaymentHistory(customerId);
        }

        // роХроЯрпНроЯрогродрпНродрпИ роирпАроХрпНроХрпБ
        function deletePayment(paymentId, customerId) {
            const payment = payments.find(p => p.id === paymentId);
            if (!payment) return;
            
            const customer = customers.find(c => c.id === customerId);
            if (!customer) return;
            
            const confirmMsg = `ро░роЪрпАродрпБ: ${payment.reference || 'роЗро▓рпНро▓рпИ'}\nродрпКроХрпИ: тВ╣${payment.amount.toLocaleString('en-IN')}\nродрпЗродро┐: ${formatDate(payment.date)}\n\nроЗроирпНрод роХроЯрпНроЯрогродрпНродрпИ роиро┐роЪрпНроЪропрооро╛роХ роирпАроХрпНроХ ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒рпАро░рпНроХро│ро╛?`;
            
            if (!confirm(confirmMsg)) return;
            
            // ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН рокрпЗро▓ройрпНро╕рпИ рокрпБродрпБрокрпНрокро┐роХрпНроХро╡рпБроорпН
            customer.paidAmount -= payment.amount;
            customer.balanceAmount = customer.totalAmount - customer.paidAmount;
            customer.status = customer.balanceAmount > 0 ? 'debtor' : 'cleared';
            
            // роХроЯрпНроЯрогродрпНродрпИ роирпАроХрпНроХро╡рпБроорпН
            payments = payments.filter(p => p.id !== paymentId);
            
            // родро░ро╡рпБроХро│рпИ роЪрпЗрооро┐роХрпНроХро╡рпБроорпН
            saveCustomers();
            savePayments();
            
            // роХроЯрпНроЯрог ро╡ро░ро▓ро╛ро▒рпНро▒рпИ роорпАрогрпНроЯрпБроорпН роХро╛роЯрпНроЯрпБ
            viewPaymentHistory(customerId);
            
            // роЯро╛ро╖рпНрокрпЛро░рпНроЯрпИ рокрпБродрпБрокрпНрокро┐роХрпНроХро╡рпБроорпН
            updateDashboard();
            
            alert('роХроЯрпНроЯрогроорпН роирпАроХрпНроХрокрпНрокроЯрпНроЯродрпБ!');
        }

        // ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН рокрпЗро▓ройрпНро╕рпН родроХро╡ро▓рпН роХро╛роЯрпНроЯрпБ
        function showCustomerBalance(id) {
            const customer = customers.find(c => c.id === id);
            if (!customer) return;
            
            const balanceInfo = document.getElementById('customer-balance-info');
            balanceInfo.style.display = 'block';
            balanceInfo.innerHTML = `
                <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; margin-top: 20px; border-left: 5px solid #2196f3;">
                    <h4 style="margin-top: 0; color: #1565c0;">ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН рокрпЗро▓ройрпНро╕рпН</h4>
                    <p><strong>рокрпЖропро░рпН:</strong> ${customer.name}</p>
                    <p><strong>роорпКродрпНрод родрпКроХрпИ:</strong> тВ╣${customer.totalAmount.toLocaleString('en-IN')}</p>
                    <p><strong>роЪрпЖро▓рпБродрпНродро┐ропродрпБ:</strong> тВ╣${customer.paidAmount.toLocaleString('en-IN')}</p>
                    <p><strong>рокрпЗро▓ройрпНро╕рпН:</strong> <span style="color: ${customer.balanceAmount > 0 ? '#e74c3c' : '#27ae60'}; font-weight: 700;">тВ╣${customer.balanceAmount.toLocaleString('en-IN')}</span></p>
                </div>
            `;
            
            // роХроЯрпНроЯрог родрпКроХрпИ рокрпБро▓родрпНродро┐ро▓рпН рокрпЗро▓ройрпНро╕рпИ роЕроорпИроХрпНроХ
            if (customer.balanceAmount > 0) {
                document.getElementById('payment-amount').value = customer.balanceAmount;
            }
        }

        // роЪрпЗро╡рпИроХро│рпИ роХро╛роЯрпНроЯрпБ (checkbox)
        function renderServicesCheckboxes() {
            let servicesHTML = '';
            
            services.forEach(service => {
                servicesHTML += `
                    <div class="checkbox-group">
                        <input type="checkbox" id="service-${service.id}" value="${service.name}">
                        <label for="service-${service.id}">${service.name} (тВ╣${service.price})</label>
                    </div>
                `;
            });
            
            servicesList.innerHTML = servicesHTML;
        }

        // роЪрпЗро╡рпИ роорпЗро▓ро╛рогрпНроорпИ
        function renderServicesManagement() {
            const servicesManagement = document.getElementById('services-management');
            
            if (services.length === 0) {
                servicesManagement.innerHTML = '<p>роЪрпЗро╡рпИроХро│рпН роЗро▓рпНро▓рпИ</p>';
                return;
            }
            
            let servicesHTML = '<table style="width: 100%;"><thead><tr><th>роЪрпЗро╡рпИ</th><th>роХроЯрпНроЯрогроорпН</th><th class="no-print">роЪрпЖропро▓рпНроХро│рпН</th></tr></thead><tbody>';
            
            services.forEach(service => {
                const usageCount = customers.filter(c => c.services.includes(service.name)).length;
                
                servicesHTML += `
                    <tr>
                        <td>
                            <strong>${service.name}</strong>
                            ${usageCount > 0 ? `<br><small style="color: #6c757d;">${usageCount} ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН</small>` : ''}
                        </td>
                        <td>тВ╣${service.price.toLocaleString('en-IN')}</td>
                        <td class="no-print">
                            <button class="small-btn outline-btn" onclick="editService(${service.id})">
                                тЬПя╕П
                            </button>
                            <button class="small-btn danger-btn" onclick="deleteService(${service.id})" ${usageCount > 0 ? 'disabled title="роЗроирпНрод роЪрпЗро╡рпИ рокропройрпНрокро╛роЯрпНроЯро┐ро▓рпН роЙро│рпНро│родрпБ"' : ''}>
                                ЁЯЧСя╕П
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            servicesHTML += '</tbody></table>';
            servicesManagement.innerHTML = servicesHTML;
        }

        // роЪрпЗро╡рпИ родро┐ро░рпБродрпНродрпБ
        function editService(id) {
            const service = services.find(s => s.id === id);
            if (!service) return;
            
            // роЪрпЗро╡рпИ рокроЯро┐ро╡родрпНродро┐ро▓рпН родро▒рпНрокрпЛродрпИроп роородро┐рокрпНрокрпБроХро│рпИ роиро┐ро░рокрпНрокрпБ
            document.getElementById('service-name').value = service.name;
            document.getElementById('service-price').value = service.price;
            
            // рокрпБродрпБрокрпНрокро┐рокрпНрокрпБ рокрпКродрпНродро╛ройрпБроХрпНроХрпБ рооро╛ро▒рпНро▒рпБ
            serviceSubmitBtn.innerHTML = 'тЬПя╕П роЪрпЗро╡рпИропрпИ рокрпБродрпБрокрпНрокро┐роХрпНроХ';
            editServiceId = id;
            
            // "роЪрпЗро╡рпИроХро│рпН" родро╛ро╡ро▓рпБроХрпНроХрпБ роЪрпЖро▓рпН
            switchTab('services');
            document.querySelector('.sidebar').scrollIntoView({ behavior: 'smooth' });
        }

        // роЪрпЗро╡рпИ рокрпБродрпБрокрпНрокро┐рокрпНрокрпБ
        function updateService(id) {
            const service = services.find(s => s.id === id);
            if (!service) return;
            
            const oldName = service.name;
            const newName = document.getElementById('service-name').value;
            const newPrice = parseInt(document.getElementById('service-price').value) || 0;
            
            // роЪрпЗро╡рпИ рокрпЖропро░рпН рооро╛ро▒рпНро▒рокрпНрокроЯрпНроЯро╛ро▓рпН, роЕройрпИродрпНродрпБ ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│ро┐ройрпН роЪрпЗро╡рпИ рокроЯрпНроЯро┐ропро▓рпИропрпБроорпН рокрпБродрпБрокрпНрокро┐роХрпНроХро╡рпБроорпН
            if (oldName !== newName) {
                customers.forEach(customer => {
                    if (customer.services.includes(oldName)) {
                        customer.services = customer.services.map(s => s === oldName ? newName : s);
                    }
                });
                saveCustomers();
            }
            
            // роЪрпЗро╡рпИ ро╡ро┐ро╡ро░роЩрпНроХро│рпИ рокрпБродрпБрокрпНрокро┐роХрпНроХро╡рпБроорпН
            service.name = newName;
            service.price = newPrice;
            
            saveServices();
            renderServicesCheckboxes();
            renderServicesManagement();
            resetServiceForm();
            renderCustomers(); // ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН рокроЯрпНроЯро┐ропро▓рпИ рокрпБродрпБрокрпНрокро┐роХрпНроХро╡рпБроорпН
            
            editServiceId = null;
            
            alert('роЪрпЗро╡рпИ ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ рокрпБродрпБрокрпНрокро┐роХрпНроХрокрпНрокроЯрпНроЯродрпБ!');
        }

        // роЪрпЗро╡рпИ роирпАроХрпНроХрпБ
        function deleteService(id) {
            const service = services.find(s => s.id === id);
            if (!service) return;
            
            const usageCount = customers.filter(c => c.services.includes(service.name)).length;
            
            if (usageCount > 0) {
                alert(`роЗроирпНрод роЪрпЗро╡рпИ ${usageCount} ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│ро╛ро▓рпН рокропройрпНрокроЯрпБродрпНродрокрпНрокроЯрпБроХро┐ро▒родрпБ. роорпБродро▓ро┐ро▓рпН роЕроирпНрод ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│ро┐роЯроорпН роЗро░рпБроирпНродрпБ роЗроирпНрод роЪрпЗро╡рпИропрпИ роирпАроХрпНроХро╡рпБроорпН.`);
                return;
            }
            
            if (!confirm(`"${service.name}" роЪрпЗро╡рпИропрпИ роиро┐роЪрпНроЪропрооро╛роХ роирпАроХрпНроХ ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒рпАро░рпНроХро│ро╛?`)) return;
            
            services = services.filter(s => s.id !== id);
            saveServices();
            renderServicesCheckboxes();
            renderServicesManagement();
            
            alert('роЪрпЗро╡рпИ роирпАроХрпНроХрокрпНрокроЯрпНроЯродрпБ!');
        }

        // роЕро▒ро┐роХрпНроХрпИ роЙро░рпБро╡ро╛роХрпНроХрпБ
        function generateReport() {
            const reportType = document.getElementById('report-type').value;
            const fromDate = document.getElementById('report-from').value;
            const toDate = document.getElementById('report-to').value;
            
            let reportHTML = '';
            
            if (reportType === 'debtors') {
                // роХроЯройро╛ро│ро┐роХро│рпН роЕро▒ро┐роХрпНроХрпИ
                const debtors = customers.filter(c => c.balanceAmount > 0);
                
                if (debtors.length === 0) {
                    reportHTML = '<div class="no-data"><p>роХроЯройро╛ро│ро┐роХро│рпН роЗро▓рпНро▓рпИ</p></div>';
                } else {
                    let debtorsHTML = '<table><thead><tr><th>ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН</th><th>родрпКро▓рпИрокрпЗроЪро┐</th><th>роорпКродрпНрод родрпКроХрпИ</th><th>роЪрпЖро▓рпБродрпНродро┐ропродрпБ</th><th>рокрпЗро▓ройрпНро╕рпН</th><th>роХроЯрпИроЪро┐ роХроЯрпНроЯрогроорпН</th></tr></thead><tbody>';
                    
                    debtors.sort((a, b) => b.balanceAmount - a.balanceAmount);
                    
                    debtors.forEach(customer => {
                        debtorsHTML += `
                            <tr>
                                <td>
                                    <strong>${customer.name}</strong><br>
                                    <small>${customer.id}</small>
                                </td>
                                <td>${customer.phone}</td>
                                <td>тВ╣${customer.totalAmount.toLocaleString('en-IN')}</td>
                                <td>тВ╣${customer.paidAmount.toLocaleString('en-IN')}</td>
                                <td style="color: #e74c3c; font-weight: 700;">тВ╣${customer.balanceAmount.toLocaleString('en-IN')}</td>
                                <td>${customer.lastPaymentDate ? formatDate(customer.lastPaymentDate) : 'роЗро▓рпНро▓рпИ'}</td>
                            </tr>
                        `;
                    });
                    
                    debtorsHTML += '</tbody></table>';
                    
                    const totalDebt = debtors.reduce((sum, c) => sum + c.balanceAmount, 0);
                    
                    reportHTML = `
                        <div class="report-card">
                            <h3 style="color: #e74c3c;">роХроЯройро╛ро│ро┐роХро│рпН роЕро▒ро┐роХрпНроХрпИ</h3>
                            <p>роорпКродрпНрод роХроЯройро╛ро│ро┐роХро│рпН: ${debtors.length} | роорпКродрпНрод роХроЯройрпН родрпКроХрпИ: тВ╣${totalDebt.toLocaleString('en-IN')}</p>
                            ${debtorsHTML}
                        </div>
                    `;
                }
            } else if (reportType === 'payments') {
                // роХроЯрпНроЯрогроЩрпНроХро│рпН роЕро▒ро┐роХрпНроХрпИ
                let filteredPayments = payments;
                
                if (fromDate) {
                    filteredPayments = filteredPayments.filter(p => p.date >= fromDate);
                }
                if (toDate) {
                    filteredPayments = filteredPayments.filter(p => p.date <= toDate);
                }
                
                if (filteredPayments.length === 0) {
                    reportHTML = '<div class="no-data"><p>роХроЯрпНроЯрог рокродро┐ро╡рпБроХро│рпН роЗро▓рпНро▓рпИ</p></div>';
                } else {
                    let paymentsHTML = '<table><thead><tr><th>родрпЗродро┐</th><th>ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН</th><th>ро░роЪрпАродрпБ</th><th>роорпБро▒рпИ</th><th>родрпКроХрпИ</th></tr></thead><tbody>';
                    
                    filteredPayments.sort((a, b) => new Date(b.date) - new Date(a.date));
                    
                    filteredPayments.forEach(payment => {
                        paymentsHTML += `
                            <tr>
                                <td>${formatDate(payment.date)}</td>
                                <td>${payment.customerName}</td>
                                <td>${payment.reference || '-'}</td>
                                <td>${getPaymentModeText(payment.mode)}</td>
                                <td style="color: #27ae60; font-weight: 700;">тВ╣${payment.amount.toLocaleString('en-IN')}</td>
                            </tr>
                        `;
                    });
                    
                    paymentsHTML += '</tbody></table>';
                    
                    const totalPayments = filteredPayments.reduce((sum, p) => sum + p.amount, 0);
                    
                    reportHTML = `
                        <div class="report-card">
                            <h3>роХроЯрпНроЯрогроЩрпНроХро│рпН роЕро▒ро┐роХрпНроХрпИ</h3>
                            <p>роорпКродрпНрод роХроЯрпНроЯрогроЩрпНроХро│рпН: ${filteredPayments.length} | роорпКродрпНрод родрпКроХрпИ: тВ╣${totalPayments.toLocaleString('en-IN')}</p>
                            ${paymentsHTML}
                        </div>
                    `;
                }
            } else if (reportType === 'services') {
                // роЪрпЗро╡рпИ ро╡ро╛ро░ро┐ропро╛рой роЕро▒ро┐роХрпНроХрпИ
                let serviceStats = {};
                
                customers.forEach(customer => {
                    customer.services.forEach(serviceName => {
                        if (!serviceStats[serviceName]) {
                            serviceStats[serviceName] = {
                                count: 0,
                                revenue: 0
                            };
                        }
                        serviceStats[serviceName].count++;
                        
                        // роЪрпЗро╡рпИроХрпНроХро╛рой роЪро░ро╛роЪро░ро┐ роХроЯрпНроЯрогроорпН (роородро┐рокрпНрокрпАроЯрпБ)
                        const service = services.find(s => s.name === serviceName);
                        if (service) {
                            serviceStats[serviceName].revenue += service.price;
                        }
                    });
                });
                
                if (Object.keys(serviceStats).length === 0) {
                    reportHTML = '<div class="no-data"><p>роЪрпЗро╡рпИ рокропройрпНрокро╛роЯрпБ родро░ро╡рпБроХро│рпН роЗро▓рпНро▓рпИ</p></div>';
                } else {
                    let servicesHTML = '<table><thead><tr><th>роЪрпЗро╡рпИ</th><th>ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН</th><th>роородро┐рокрпНрокро┐роЯрокрпНрокроЯрпНроЯ ро╡ро░рпБро╡ро╛ропрпН</th><th>роЪродро╡рпАродроорпН</th></tr></thead><tbody>';
                    
                    Object.keys(serviceStats).sort((a, b) => serviceStats[b].count - serviceStats[a].count).forEach(serviceName => {
                        const stats = serviceStats[serviceName];
                        const percentage = ((stats.count / customers.length) * 100).toFixed(1);
                        
                        servicesHTML += `
                            <tr>
                                <td><strong>${serviceName}</strong></td>
                                <td>${stats.count}</td>
                                <td>тВ╣${stats.revenue.toLocaleString('en-IN')}</td>
                                <td>${percentage}%</td>
                            </tr>
                        `;
                    });
                    
                    servicesHTML += '</tbody></table>';
                    
                    reportHTML = `
                        <div class="report-card">
                            <h3>роЪрпЗро╡рпИ ро╡ро╛ро░ро┐ропро╛рой роЕро▒ро┐роХрпНроХрпИ</h3>
                            <p>роорпКродрпНрод ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН: ${customers.length}</p>
                            ${servicesHTML}
                        </div>
                    `;
                }
            } else {
                // ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН роЕро▒ро┐роХрпНроХрпИ
                let filteredCustomers = customers;
                
                if (fromDate) {
                    filteredCustomers = filteredCustomers.filter(c => c.registrationDate >= fromDate);
                }
                if (toDate) {
                    filteredCustomers = filteredCustomers.filter(c => c.registrationDate <= toDate);
                }
                
                if (filteredCustomers.length === 0) {
                    reportHTML = '<div class="no-data"><p>ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН роЗро▓рпНро▓рпИ</p></div>';
                } else {
                    let customersHTML = '<table><thead><tr><th>рокродро┐ро╡рпБ родрпЗродро┐</th><th>ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН</th><th>родрпКро▓рпИрокрпЗроЪро┐</th><th>роЪрпЗро╡рпИроХро│рпН</th><th>роорпКродрпНрод родрпКроХрпИ</th><th>рокрпЗро▓ройрпНро╕рпН</th></tr></thead><tbody>';
                    
                    filteredCustomers.sort((a, b) => new Date(b.registrationDate) - new Date(a.registrationDate));
                    
                    filteredCustomers.forEach(customer => {
                        customersHTML += `
                            <tr>
                                <td>${formatDate(customer.registrationDate)}</td>
                                <td>
                                    <strong>${customer.name}</strong><br>
                                    <small>${customer.id}</small>
                                </td>
                                <td>${customer.phone}</td>
                                <td>
                                    <div class="service-tags">
                                        ${customer.services.slice(0, 2).map(service => `<span class="service-tag">${service}</span>`).join('')}
                                        ${customer.services.length > 2 ? `<span class="service-tag">+${customer.services.length - 2}</span>` : ''}
                                    </div>
                                </td>
                                <td>тВ╣${customer.totalAmount.toLocaleString('en-IN')}</td>
                                <td style="color: ${customer.balanceAmount > 0 ? '#e74c3c' : '#27ae60'}; font-weight: 700;">тВ╣${customer.balanceAmount.toLocaleString('en-IN')}</td>
                            </tr>
                        `;
                    });
                    
                    customersHTML += '</tbody></table>';
                    
                    const newCustomers = filteredCustomers.length;
                    const totalRevenue = filteredCustomers.reduce((sum, c) => sum + c.totalAmount, 0);
                    const totalPaid = filteredCustomers.reduce((sum, c) => sum + c.paidAmount, 0);
                    
                    reportHTML = `
                        <div class="report-card">
                            <h3>ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН роЕро▒ро┐роХрпНроХрпИ</h3>
                            <p>рокрпБродро┐роп ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпНроХро│рпН: ${newCustomers} | роорпКродрпНрод ро╡ро░рпБро╡ро╛ропрпН: тВ╣${totalRevenue.toLocaleString('en-IN')} | роЪрпЖро▓рпБродрпНродрокрпНрокроЯрпНроЯродрпБ: тВ╣${totalPaid.toLocaleString('en-IN')}</p>
                            ${customersHTML}
                        </div>
                    `;
                }
            }
            
            document.getElementById('report-output').innerHTML = reportHTML;
        }

        // роЯро╛ро╖рпНрокрпЛро░рпНроЯрпБ рокрпБродрпБрокрпНрокро┐
        function updateDashboard() {
            const totalCustomers = customers.length;
            const activeCustomers = customers.filter(c => c.services.length > 0).length;
            const totalDebt = customers.reduce((sum, c) => sum + c.balanceAmount, 0);
            const totalRevenue = customers.reduce((sum, c) => sum + c.paidAmount, 0);
            
            document.getElementById('total-customers').textContent = totalCustomers;
            document.getElementById('active-customers').textContent = activeCustomers;
            document.getElementById('total-debt').textContent = `тВ╣${totalDebt.toLocaleString('en-IN')}`;
            document.getElementById('total-revenue').textContent = `тВ╣${totalRevenue.toLocaleString('en-IN')}`;
        }

        // роХроЯрпНроЯрог ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН родрпЗро░рпНро╡рпИ рокрпБродрпБрокрпНрокро┐
        function updatePaymentCustomerSelect() {
            let options = '<option value="">ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН</option>';
            
            customers.sort((a, b) => a.name.localeCompare(b.name)).forEach(customer => {
                const balanceText = customer.balanceAmount > 0 ? ` (рокрпЗро▓ройрпНро╕рпН: тВ╣${customer.balanceAmount.toLocaleString('en-IN')})` : '';
                options += `<option value="${customer.id}">${customer.name}${balanceText}</option>`;
            });
            
            paymentCustomerSelect.innerHTML = options;
        }

        // родро╛ро╡ро▓рпНроХро│рпН рооро╛ро▒рпНро▒роорпН
        function switchTab(tabName) {
            // родро╛ро╡ро▓рпН рокрпКродрпНродро╛ройрпНроХро│рпН
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.tab-btn[onclick="switchTab('${tabName}')"]`).classList.add('active');
            
            // родро╛ро╡ро▓рпН роЙро│рпНро│роЯроХрпНроХроорпН
            document.querySelectorAll('.form-container, .services-container, .reports-container').forEach(container => {
                container.classList.remove('active');
            });
            
            // роорпБроХрпНроХро┐роп роЙро│рпНро│роЯроХрпНроХроорпН
            document.getElementById('customers-tab').style.display = tabName === 'customers' ? 'block' : 'none';
            
            if (tabName === 'customer' || tabName === 'payment' || tabName === 'services' || tabName === 'reports') {
                document.getElementById(`${tabName}-tab`).classList.add('active');
            }
            
            if (tabName === 'services') {
                renderServicesManagement();
            }
            
            if (tabName === 'reports') {
                document.getElementById('report-from').valueAsDate = new Date(new Date().setDate(1));
                document.getElementById('report-to').valueAsDate = new Date();
            }
            
            // рокрпЗро▓ройрпНро╕рпН родроХро╡ро▓рпИ рооро▒рпИ
            document.getElementById('customer-balance-info').style.display = 'none';
        }

        // родрпЗроЯро▓рпН рооро▒рпНро▒рпБроорпН ро╡роЯро┐роХроЯрпНроЯро▓рпН
        searchInput.addEventListener('input', updateFilters);
        filterStatusSelect.addEventListener('change', updateFilters);
        
        function updateFilters() {
            renderCustomers(
                searchInput.value,
                filterStatusSelect.value
            );
        }
        
        function clearFilters() {
            searchInput.value = '';
            filterStatusSelect.value = 'all';
            renderCustomers();
        }

        // рокроЯро┐ро╡роЩрпНроХро│рпИ роорпАроЯрпНроЯроорпИ
        function resetCustomerForm() {
            customerForm.reset();
            document.getElementById('customer-id').value = '';
            document.getElementById('submit-btn').style.display = 'block';
            document.getElementById('update-btn').style.display = 'none';
            document.getElementById('cancel-btn').style.display = 'none';
            editCustomerId = null;
            
            // роЪрпЗро╡рпИроХро│рпИ родрпЗро░рпНро╡рпБ роирпАроХрпНроХ
            document.querySelectorAll('#services-list input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = false;
            });
        }
        
        function resetPaymentForm() {
            paymentForm.reset();
            document.getElementById('payment-date').valueAsDate = new Date();
            document.getElementById('customer-balance-info').style.display = 'none';
        }
        
        function resetServiceForm() {
            serviceForm.reset();
            serviceSubmitBtn.innerHTML = 'тЮХ роЪрпЗро╡рпИропрпИ роЪрпЗро░рпНроХрпНроХ';
            editServiceId = null;
        }

        // роЕроЪрпНроЪро┐роЯрпБ роЪрпЖропро▓рпНрокро╛роЯрпБроХро│рпН
        function printCustomerList() {
            const originalTitle = document.title;
            document.title = `родро╛ро╕рпН рокрпКродрпБ роЪрпЗро╡рпИ роорпИропроорпН - ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН рокроЯрпНроЯро┐ропро▓рпН - ${new Date().toLocaleDateString('ta-IN')}`;
            window.print();
            setTimeout(() => { document.title = originalTitle; }, 1000);
        }
        
        function printCustomerDetails(id) {
            const customer = customers.find(c => c.id === id);
            if (!customer) return;
            
            const originalTitle = document.title;
            document.title = `родро╛ро╕рпН - ${customer.name} - ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН ро╡ро┐ро╡ро░роЩрпНроХро│рпН - ${new Date().toLocaleDateString('ta-IN')}`;
            window.print();
            setTimeout(() => { document.title = originalTitle; }, 1000);
        }
        
        function printReport() {
            const originalTitle = document.title;
            document.title = `родро╛ро╕рпН рокрпКродрпБ роЪрпЗро╡рпИ роорпИропроорпН - роЕро▒ро┐роХрпНроХрпИ - ${new Date().toLocaleDateString('ta-IN')}`;
            window.print();
            setTimeout(() => { document.title = originalTitle; }, 1000);
        }

        // родро░ро╡рпБ роПро▒рпНро▒рпБроородро┐/роЗро▒роХрпНроХрпБроородро┐
        function exportData() {
            const data = {
                customers: customers,
                services: services,
                payments: payments,
                exportDate: new Date().toISOString(),
                company: {
                    name: "родро╛ро╕рпН рокрпКродрпБ роЪрпЗро╡рпИ роорпИропроорпН",
                    address: "147роО, роХро┐ро░рпЗроЯрпН роХро╛роЯрпНроЯройрпН ро░рпЛроЯрпБ, роородрпНродро┐роп рокро╛роХроорпН роХро╛ро╡ро▓рпН роиро┐ро▓рпИропроорпН роОродро┐ро░ро┐ро▓рпН, родрпВродрпНродрпБроХрпНроХрпБроЯро┐-628001",
                    phones: ["98 43 23 23 24", "88 70 23 23 32", "95 85 33 43 65"],
                    email: "dhasscsc@gmail.com"
                }
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `dass-csc-backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert('роЕройрпИродрпНродрпБ родро░ро╡рпБроХро│рпБроорпН ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ роПро▒рпНро▒рпБроородро┐ роЪрпЖропрпНропрокрпНрокроЯрпНроЯрой!');
        }
        
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        if (confirm('родро▒рпНрокрпЛродрпИроп родро░ро╡рпБроХро│рпН роЕро┤ро┐роХрпНроХрокрпНрокроЯрпБроорпН. родрпКроЯро░ ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒рпАро░рпНроХро│ро╛?')) {
                            customers = data.customers || [];
                            services = data.services || [];
                            payments = data.payments || [];
                            
                            saveCustomers();
                            saveServices();
                            savePayments();
                            
                            renderCustomers();
                            renderServicesCheckboxes();
                            renderServicesManagement();
                            updateDashboard();
                            updatePaymentCustomerSelect();
                            
                            alert('родро░ро╡рпБроХро│рпН ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ роЗро▒роХрпНроХрпБроородро┐ роЪрпЖропрпНропрокрпНрокроЯрпНроЯрой!');
                        }
                    } catch (error) {
                        alert('родро░ро╡рпБроХро│рпИ роЗро▒роХрпНроХрпБроородро┐ роЪрпЖропрпНроп роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ. роХрпЛрокрпНрокрпБ роЪро░ро┐ропро╛рой ро╡роЯро┐ро╡родрпНродро┐ро▓рпН роЗро▓рпНро▓рпИ.');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }

        // родро░ро╡рпБроХро│рпИ роЪрпЗрооро┐
        function saveCustomers() {
            localStorage.setItem('dassCustomers', JSON.stringify(customers));
        }
        
        function saveServices() {
            localStorage.setItem('dassServices', JSON.stringify(services));
        }
        
        function savePayments() {
            localStorage.setItem('dassPayments', JSON.stringify(payments));
        }

        // роЙродро╡ро┐ роЪрпЖропро▓рпНрокро╛роЯрпБроХро│рпН
        function formatDate(dateString) {
            if (!dateString) return 'родрпЖро░ро┐ропро╡ро┐ро▓рпНро▓рпИ';
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('ta-IN', options);
        }
        
        function getPaymentModeText(mode) {
            const modes = {
                'cash': 'рокрогроорпН',
                'online': 'роЖройрпНро▓рпИройрпН',
                'cheque': 'роЪрпЖроХрпН',
                'upi': 'UPI'
            };
            return modes[mode] || mode;
        }

        // роЕроЪрпНроЪро┐роЯрпБроорпН рокрпЛродрпБ родро▓рпИрокрпНрокрпБ роЪрпЗро░рпНроХрпНроХ
        window.onbeforeprint = function() {
            const printHeader = document.createElement('div');
            printHeader.className = 'print-header';
            printHeader.innerHTML = `
                <h2>родро╛ро╕рпН рокрпКродрпБ роЪрпЗро╡рпИ роорпИропроорпН - ро╡ро╛роЯро┐роХрпНроХрпИропро╛ро│ро░рпН роорпЗро▓ро╛рогрпНроорпИ</h2>
                <p>147роО, роХро┐ро░рпЗроЯрпН роХро╛роЯрпНроЯройрпН ро░рпЛроЯрпБ, роородрпНродро┐роп рокро╛роХроорпН роХро╛ро╡ро▓рпН роиро┐ро▓рпИропроорпН роОродро┐ро░ро┐ро▓рпН, родрпВродрпНродрпБроХрпНроХрпБроЯро┐-628001</p>
                <p>роЕроЪрпНроЪро┐роЯрпНроЯ родрпЗродро┐: ${new Date().toLocaleDateString('ta-IN', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</p>
            `;
            document.body.insertBefore(printHeader, document.querySelector('.container'));
        };

        window.onafterprint = function() {
            const printHeader = document.querySelector('.print-header');
            if (printHeader) printHeader.remove();
        };

        // рооро╛родро┐ро░ро┐ родро░ро╡рпБ (роорпБродро▓рпН роорпБро▒рпИ рокропройрпНрокроЯрпБродрпНродрпБроорпН рокрпЛродрпБ)
        if (customers.length === 0) {
            const sampleDate = new Date();
            sampleDate.setMonth(sampleDate.getMonth() - 1);
            
            customers = [
                {
                    id: 'DASS001',
                    name: 'ро░роорпЗро╖рпН роХрпБрооро╛ро░рпН',
                    phone: '9843232324',
                    phone2: '8870232332',
                    address: '45, роироирпНродройроорпН, родрпВродрпНродрпБроХрпНроХрпБроЯро┐-628001',
                    aadhar: '1234 5678 9012',
                    services: ['роЖродро╛ро░рпН роХро╛ро░рпНроЯрпБ', 'рокро╛ройрпН роХро╛ро░рпНроЯрпБ'],
                    totalAmount: 200,
                    paidAmount: 200,
                    balanceAmount: 0,
                    notes: 'ро╡ро┐ро░рпИро╡ро╛рой роЪрпЗро╡рпИ',
                    status: 'cleared',
                    registrationDate: sampleDate.toISOString().split('T')[0],
                    lastPaymentDate: sampleDate.toISOString().split('T')[0]
                },
                {
                    id: 'DASS002',
                    name: 'роЪрпБро░рпЗро╖рпН рокро╛ро▓рпБ',
                    phone: '9585334365',
                    phone2: '',
                    address: '78, рокрпЖро░ро┐ропро╛ро░рпН роироХро░рпН, родрпВродрпНродрпБроХрпНроХрпБроЯро┐',
                    aadhar: '9876 5432 1012',
                    services: ['рокро╛ро╕рпНрокрпЛро░рпНроЯрпН', 'ро╡ро╛роХрой ро▓рпИроЪрпЖройрпНро╕рпН'],
                    totalAmount: 2000,
                    paidAmount: 1000,
                    balanceAmount: 1000,
                    notes: 'рокрпЗро▓ройрпНро╕рпН роЙро│рпНро│родрпБ',
                    status: 'debtor',
                    registrationDate: new Date().toISOString().split('T')[0],
                    lastPaymentDate: new Date().toISOString().split('T')[0]
                }
            ];
            
            payments = [
                {
                    id: 'PAY001',
                    customerId: 'DASS001',
                    customerName: 'ро░роорпЗро╖рпН роХрпБрооро╛ро░рпН',
                    date: sampleDate.toISOString().split('T')[0],
                    amount: 200,
                    mode: 'cash',
                    reference: 'RC001',
                    notes: 'роорпБро┤рпБродрпБроорпН роЪрпЖро▓рпБродрпНродро┐ропродрпБ',
                    timestamp: sampleDate.toISOString()
                },
                {
                    id: 'PAY002',
                    customerId: 'DASS002',
                    customerName: 'роЪрпБро░рпЗро╖рпН рокро╛ро▓рпБ',
                    date: new Date().toISOString().split('T')[0],
                    amount: 1000,
                    mode: 'online',
                    reference: 'UPI123',
                    notes: 'роорпБродро▓рпН роХроЯрпНроЯрогроорпН',
                    timestamp: new Date().toISOString()
                }
            ];
            
            saveCustomers();
            savePayments();
            renderCustomers();
            updateDashboard();
            updatePaymentCustomerSelect();
        }
    </script>
</body>
</html>